{% extends "base.html" %}

{% block progress_bar %}
<div class="progress-display">
    <span class="progress-label">Progress:</span>
    <span class="progress-percentage">100%</span>
</div>
{% endblock %}

{% block extra_css %}
<style>
    body {
        overflow: hidden;
    }

    .finale-container {
        width: 100vw;
        height: 100vh;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%);
        overflow: hidden;
    }

    /* Snow animation */
    .snow {
        position: absolute;
        top: -10px;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
    }

    .snowflake {
        position: absolute;
        color: rgba(255, 255, 255, 0.8);
        font-size: 1.5rem;
        animation: fall linear infinite;
        opacity: 0.7;
    }

    @keyframes fall {
        0% {
            transform: translateY(-100px) translateX(0) rotate(0deg);
            opacity: 0;
        }
        10% {
            opacity: 0.7;
        }
        90% {
            opacity: 0.7;
        }
        100% {
            transform: translateY(100vh) translateX(50px) rotate(360deg);
            opacity: 0;
        }
    }

    /* Main content */
    .finale-content {
        position: relative;
        z-index: 10;
        text-align: center;
        color: #ffffff;
        max-width: 900px;
        padding: 2rem;
    }

    /* Santa entrance animation */
    .santa-container {
        margin-bottom: 3rem;
        animation: santaEntrance 2s ease-out;
    }

    @keyframes santaEntrance {
        0% {
            opacity: 0;
            transform: translateY(-50px) scale(0.8);
        }
        100% {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .santa-icon {
        font-size: 8rem;
        animation: santaFloat 3s ease-in-out infinite;
        filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.3));
    }

    @keyframes santaFloat {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-20px);
        }
    }

    /* Message reveal animations */
    .finale-title {
        font-size: 3.5rem;
        font-weight: 300;
        margin-bottom: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        animation: titleReveal 1.5s ease-out 0.5s both;
        background: linear-gradient(135deg, #ffffff 0%, #ffd700 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
    }

    @keyframes titleReveal {
        0% {
            opacity: 0;
            transform: translateY(30px);
            filter: blur(10px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
            filter: blur(0);
        }
    }

    .santa-message {
        font-size: 1.5rem;
        line-height: 1.8;
        color: #e0e0e0;
        margin-bottom: 3rem;
        animation: messageReveal 1.5s ease-out 1s both;
        font-style: italic;
    }

    @keyframes messageReveal {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .success-banner {
        background: linear-gradient(135deg, rgba(76, 175, 80, 0.2) 0%, rgba(76, 175, 80, 0.1) 100%);
        border: 2px solid #4CAF50;
        border-radius: 20px;
        padding: 2.5rem;
        margin: 3rem 0;
        animation: bannerReveal 1.5s ease-out 1.5s both;
        box-shadow: 0 0 40px rgba(76, 175, 80, 0.3);
        position: relative;
        overflow: hidden;
    }

    .success-banner::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(76, 175, 80, 0.1) 0%, transparent 70%);
        animation: pulseGlow 3s ease-in-out infinite;
    }

    @keyframes pulseGlow {
        0%, 100% {
            transform: scale(1);
            opacity: 0.5;
        }
        50% {
            transform: scale(1.1);
            opacity: 0.8;
        }
    }

    @keyframes bannerReveal {
        0% {
            opacity: 0;
            transform: scale(0.9) translateY(30px);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    .success-text {
        font-size: 2.5rem;
        font-weight: 600;
        color: #4CAF50;
        text-transform: uppercase;
        letter-spacing: 0.15em;
        position: relative;
        z-index: 1;
        animation: textGlow 2s ease-in-out infinite;
    }

    @keyframes textGlow {
        0%, 100% {
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        50% {
            text-shadow: 0 0 30px rgba(76, 175, 80, 0.8), 0 0 50px rgba(76, 175, 80, 0.4);
        }
    }

    .finale-description {
        font-size: 1.2rem;
        color: #aaa;
        margin-top: 1.5rem;
        line-height: 1.6;
        position: relative;
        z-index: 1;
    }

    /* Stars background */
    .stars {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 2;
    }

    .star {
        position: absolute;
        width: 2px;
        height: 2px;
        background: #ffffff;
        border-radius: 50%;
        animation: twinkle 3s ease-in-out infinite;
    }

    @keyframes twinkle {
        0%, 100% {
            opacity: 0.3;
            transform: scale(1);
        }
        50% {
            opacity: 1;
            transform: scale(1.5);
        }
    }

    /* Action buttons */
    .finale-actions {
        margin-top: 3rem;
        animation: buttonsReveal 1.5s ease-out 2s both;
        display: flex;
        gap: 1.5rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    @keyframes buttonsReveal {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .back-button, .home-button, .replay-button {
        display: inline-block;
        padding: 1rem 2.5rem;
        color: #ffffff;
        border: 2px solid #ffffff;
        text-decoration: none;
        font-size: 1rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        transition: all 0.3s ease;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.1);
    }

    .replay-button {
        border-color: #ffd700;
        background: rgba(255, 215, 0, 0.2);
        color: #ffd700;
    }

    .back-button:hover, .home-button:hover {
        background: #ffffff;
        color: #1a1a1a;
        transform: translateY(-3px);
        box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3);
    }

    .replay-button:hover {
        background: #ffd700;
        color: #1a1a1a;
        transform: translateY(-3px);
        box-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
    }

    /* Confetti effect */
    .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        background: #ffd700;
        position: absolute;
        animation: confettiFall 3s linear infinite;
    }

    @keyframes confettiFall {
        0% {
            transform: translateY(-100px) rotate(0deg);
            opacity: 1;
        }
        100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
        }
    }

    /* Responsive */
    @media (max-width: 768px) {
        .finale-title {
            font-size: 2rem;
        }

        .santa-icon {
            font-size: 5rem;
        }

        .success-text {
            font-size: 1.8rem;
        }

        .santa-message {
            font-size: 1.2rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="finale-container">
    <!-- Snow effect -->
    <div class="snow" id="snow"></div>
    
    <!-- Stars background -->
    <div class="stars" id="stars"></div>

    <div class="finale-content">
        <!-- Santa -->
        <div class="santa-container">
            <div class="santa-icon">ðŸŽ…</div>
        </div>

        <!-- Title -->
        <h1 class="finale-title">Thank You</h1>

        <!-- Santa's Message -->
        <div class="santa-message">
            "Your dedication and care have made this Christmas possible. 
            Through fixing toys, navigating challenges, making difficult decisions, 
            and spreading joy across the world, you've shown the true spirit of Christmas. 
            Every child will receive their gift, and every heart will be filled with warmth. 
            You've done something truly special."
        </div>

        <!-- Success Banner -->
        <div class="success-banner">
            <div class="success-text">ðŸŽ„ Christmas Successfully Delivered ðŸŽ„</div>
            <div class="finale-description">
                All modules completed. All regions served. All hearts warmed.
                <br>Mission accomplished.
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="finale-actions">
            <a href="{{ url_for('map') }}" class="back-button">Back to Control Room</a>
            <a href="{{ url_for('index') }}" class="home-button">Return Home</a>
            <a href="{{ url_for('reset') }}" class="replay-button">ðŸ”„ Replay Game</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Create snowflakes
    function createSnow() {
        const snowContainer = document.getElementById('snow');
        const snowflakeCount = 50;
        
        for (let i = 0; i < snowflakeCount; i++) {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';
            snowflake.textContent = 'â„';
            snowflake.style.left = Math.random() * 100 + '%';
            snowflake.style.animationDuration = (Math.random() * 3 + 2) + 's';
            snowflake.style.animationDelay = Math.random() * 2 + 's';
            snowContainer.appendChild(snowflake);
        }
    }

    // Create stars
    function createStars() {
        const starsContainer = document.getElementById('stars');
        const starCount = 100;
        
        for (let i = 0; i < starCount; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDelay = Math.random() * 3 + 's';
            star.style.animationDuration = (Math.random() * 2 + 2) + 's';
            starsContainer.appendChild(star);
        }
    }

    // Create confetti
    function createConfetti() {
        const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#95e1d3', '#f38181'];
        const confettiCount = 30;
        
        for (let i = 0; i < confettiCount; i++) {
            setTimeout(() => {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                confetti.style.width = (Math.random() * 10 + 5) + 'px';
                confetti.style.height = (Math.random() * 10 + 5) + 'px';
                document.querySelector('.finale-container').appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }, i * 100);
        }
    }

    // Initialize effects
    window.addEventListener('DOMContentLoaded', () => {
        createSnow();
        createStars();
        
        // Trigger confetti after a delay
        setTimeout(() => {
            createConfetti();
        }, 2000);
    });
</script>
{% endblock %}
